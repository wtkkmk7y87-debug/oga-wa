<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>åœ°å›³ãƒ†ã‚¹ãƒˆ</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body {
  height: 100%;
  margin: 0;
}
#map {
  width: 100%;
  height: 100%;
}
button {
  position: fixed;
  left: 10px;
  z-index: 1000;
  padding: 6px 10px;
}
#btn-start { top: 10px; }
#btn-goal  { top: 50px; }
</style>
</head>

<body>

<button id="btn-start">ğŸ“ ç¾åœ¨åœ°</button>
<button id="btn-goal">ğŸ¯ ç›®çš„åœ°</button>

<div id="map"></div>

<script>
// ===== ç”»åƒã‚µã‚¤ã‚º =====
const imageWidth  = 3312;
const imageHeight = 3392;

// ===== åœ°å›³ =====
const bounds = [[0, 0], [imageHeight, imageWidth]];
const map = L.map('map', {
  crs: L.CRS.Simple,
  minZoom: -2,
  maxZoom: 2
});
L.imageOverlay('map.png', bounds).addTo(map);
map.fitBounds(bounds);

// ===== çŠ¶æ…‹ =====
let mode = null; // "start" or "goal"
let startMarker = null;
let goalMarker  = null;
let routeLine   = null;

// ===== ãƒ«ãƒ¼ãƒˆæç”» =====
function drawRoute() {
  if (!startMarker || !goalMarker) return;

  if (routeLine) map.removeLayer(routeLine);

  routeLine = L.polyline([
    startMarker.getLatLng(),
    goalMarker.getLatLng()
  ], {
    color: 'blue',
    weight: 4
  }).addTo(map);
}

// ===== ãƒœã‚¿ãƒ³ =====
document.getElementById("btn-start").onclick = () => {
  mode = "start";
  alert("åœ°å›³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç¾åœ¨åœ°ã‚’ç½®ã„ã¦ãã ã•ã„");
};

document.getElementById("btn-goal").onclick = () => {
  mode = "goal";
  alert("åœ°å›³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç›®çš„åœ°ã‚’ç½®ã„ã¦ãã ã•ã„");
};

// ===== åœ°å›³ã‚¯ãƒªãƒƒã‚¯ï¼ˆ1å›ã ã‘ï¼‰ =====
map.on("click", e => {
  if (mode === "start") {
    if (startMarker) map.removeLayer(startMarker);
    startMarker = L.marker(e.latlng)
      .addTo(map)
      .bindPopup("ç¾åœ¨åœ°")
      .openPopup();
  }

  if (mode === "goal") {
    if (goalMarker) map.removeLayer(goalMarker);
    goalMarker = L.marker(e.latlng)
      .addTo(map)
      .bindPopup("ç›®çš„åœ°")
      .openPopup();
  }

  mode = null; // ãƒ¢ãƒ¼ãƒ‰è§£é™¤
  drawRoute();
});
</script>

</body>
</html>
