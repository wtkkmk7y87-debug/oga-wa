<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>åœ°å›³ãƒ†ã‚¹ãƒˆ</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body {
  height: 100%;
  margin: 0;
}
#map {
  width: 100%;
  height: 100%;
  background: #ddd;
}
button {
  position: fixed;
  left: 10px;
  z-index: 1000;
  padding: 6px 10px;
}
#btn-start { top: 10px; }
#btn-goal  { top: 50px; }
</style>
</head>

<body>

<button id="btn-start">ğŸ“ ç¾åœ¨åœ°ã‚’ç½®ã</button>
<button id="btn-goal">ğŸ¯ ç›®çš„åœ°ã‚’ç½®ã</button>

<div id="map"></div>

<script>
// ===== ç”»åƒã‚µã‚¤ã‚ºï¼ˆä»®ã§OKï¼‰ =====
const imageWidth  = 3312;
const imageHeight = 3392;

// ===== Leafletè¨­å®š =====
const bounds = [[0, 0], [imageHeight, imageWidth]];

const map = L.map('map', {
  crs: L.CRS.Simple,
  minZoom: -2,
  maxZoom: 2
});

L.imageOverlay('map.png', bounds).addTo(map);
map.fitBounds(bounds);

// ===== ãƒãƒ¼ã‚«ãƒ¼ =====
let startMarker = null;
let goalMarker  = null;
let routeLine   = null;

// ===== ãƒ«ãƒ¼ãƒˆæç”» =====
function drawRoute() {
  if (!startMarker || !goalMarker) return;

  if (routeLine) map.removeLayer(routeLine);

  routeLine = L.polyline([
    startMarker.getLatLng(),
    goalMarker.getLatLng()
  ], {
    color: 'blue',
    weight: 4
  }).addTo(map);
}

// ===== ç¾åœ¨åœ°ã‚’ç½®ã =====
document.getElementById("btn-start").onclick = () => {
  alert("åœ°å›³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç¾åœ¨åœ°ã‚’ç½®ã„ã¦ãã ã•ã„");

  map.once("click", e => {
    if (startMarker) map.removeLayer(startMarker);

    startMarker = L.marker(e.latlng)
      .addTo(map)
      .bindPopup("ç¾åœ¨åœ°")
      .openPopup();

    drawRoute();
  });
};

// ===== ç›®çš„åœ°ã‚’ç½®ã =====
document.getElementById("btn-goal").onclick = () => {
  alert("åœ°å›³ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ç›®çš„åœ°ã‚’ç½®ã„ã¦ãã ã•ã„");

  map.once("click", e => {
    if (goalMarker) map.removeLayer(goalMarker);

    goalMarker = L.marker(e.latlng)
      .addTo(map)
      .bindPopup("ç›®çš„åœ°")
      .openPopup();

    drawRoute();
  });
};
</script>

</body>
</html>
