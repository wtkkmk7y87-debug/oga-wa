<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>ç”»åƒåœ°å›³ Ã— GPSãƒŠãƒ“ï¼ˆå®‰å®šç‰ˆï¼‰</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
html, body {
  height: 100%;
  margin: 0;
}
#map {
  width: 100%;
  height: 100%;
}

/* GPSãƒœã‚¿ãƒ³ */
#gpsBtn {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 1000;
  font-size: 22px;
  padding: 12px 18px;
  border-radius: 10px;
  border: none;
  background: #2c7be5;
  color: white;
}

/* å‡¡ä¾‹ */
#legend {
  position: fixed;
  bottom: 15px;
  right: 15px;
  z-index: 1000;
  background: rgba(255,255,255,0.9);
  padding: 10px 14px;
  border-radius: 8px;
  font-size: 16px;
  line-height: 1.6;
}

/* ğŸ“ã‚¢ã‚¤ã‚³ãƒ³ */
.pin-blue {
  font-size: 48px;
  color: #1e6fff;
}
.pin-red {
  font-size: 48px;
  color: red;
}
</style>
</head>

<body>

<button id="gpsBtn">ğŸ“ GPSã‚’è¡¨ç¤º</button>

<div id="legend">
  <div>ğŸ”µğŸ“ãƒ»ãƒ»ãƒ»ç¾åœ¨åœ°</div>
  <div>ğŸ”´ğŸ“ãƒ»ãƒ»ãƒ»ç›®çš„åœ°</div>
</div>

<div id="map"></div>

<script>
/* ===============================
â‘  ç”»åƒã‚µã‚¤ã‚º
================================ */
const imageWidth  = 1264;
const imageHeight = 1295;

/* ===============================
â‘¡ åœ°å›³è¡¨ç¤ºï¼ˆç”»åƒï¼‰
================================ */
const bounds = [[0,0],[imageHeight,imageWidth]];
const map = L.map("map", {
  crs: L.CRS.Simple,
  minZoom: -2,
  maxZoom: 2
});
L.imageOverlay("map.jpg", bounds).addTo(map);
map.fitBounds(bounds);

/* ===============================
â‘¢ ğŸ“ã‚¢ã‚¤ã‚³ãƒ³
================================ */
const bluePin = L.divIcon({
  className: "pin-blue",
  html: "ğŸ“",
  iconSize: [48,48],
  iconAnchor: [24,48]
});
const redPin = L.divIcon({
  className: "pin-red",
  html: "ğŸ“",
  iconSize: [48,48],
  iconAnchor: [24,48]
});

/* ===============================
â‘£ é“ãƒ‡ãƒ¼ã‚¿ï¼ˆã“ã“ã«ç‚¹ã‚’è¿½åŠ ï¼‰
â€» [x, y] = ç”»åƒãƒ”ã‚¯ã‚»ãƒ«åº§æ¨™
================================ */
const roads = [
  [
    [320,573],
    [557,608],
    [769,599],
    [779,664],
    [779,730],
    [782,775],
    [771,821],
    [817,815],
    [997,838],
    [1078,777]
  ]
];

// é“ã‚’æç”»
roads.forEach(r => {
  L.polyline(
    r.map(p => [p[1], p[0]]),
    { color:"#aaa", weight:6 }
  ).addTo(map);
});

/* ===============================
â‘¤ ç¾åœ¨åœ°ï¼ˆä»®ï¼šåœ°å›³ä¸­å¤®ã‚¹ã‚¿ãƒ¼ãƒˆï¼‰
â€» GPSå¤‰æ›ã¯æ¬¡ã®æ®µéšã§å…¥ã‚Œã‚‹
================================ */
let currentMarker = null;

document.getElementById("gpsBtn").onclick = () => {
  if (!currentMarker) {
    currentMarker = L.marker(
      [imageHeight/2, imageWidth/2],
      { icon: bluePin }
    ).addTo(map);
  }
};

/* ===============================
â‘¥ ç›®çš„åœ°
================================ */
let goalMarker = null;
map.on("click", e => {
  if (goalMarker) map.removeLayer(goalMarker);
  goalMarker = L.marker(e.latlng, { icon: redPin }).addTo(map);
});
</script>

</body>
</html>
